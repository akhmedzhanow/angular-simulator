@if (isLoading) {
    <div id="page-loader" class="page-loader" aria-label="Загрузка страницы">
        <div class="page-loader__inner">
            <img class="page-loader__icon" src="/loading-icon.svg" alt="loading-icon" width="50" height="50">
            <span class="page-loader__text">Загрузка...</span>
        </div>
    </div>
} @else {
    <div class="page">
        <div class="notification-stack" aria-live="polite" aria-relevant="additions removals">
            @for (msg of messages; track msg) {
                <ng-container
                    [ngTemplateOutlet]="messageTpl"
                    [ngTemplateOutletContext]="{ type: msg.type, text: msg.text, msg: msg }"
                />
            }
        </div>
        <header class="header">
            <div class="container header__inner">
                <div class="logo">
                    <img class="logo__icon" src="/logo-rumtibet.svg" alt="logo-rumtibet">
                    <span class="logo__text">{{ companyName }}</span>
                </div>
                <div class="header__actions">
                    <nav class="nav" aria-label="Навигация">
                        <ul class="nav__list">
                            <li class="nav__item">
                                <a id="nav-home-link" class="nav__link" href="#">Главная</a>
                            </li>
                            <li class="nav__item">
                                <a id="nav-about-guide-link" class="nav__link" href="#">Про гида</a>
                            </li>
                            <li class="nav__item">
                             <a id="nav-tour-program-link" class="nav__link" href="#">Программа тура</a>
                            </li>
                            <li class="nav__item">
                                <a id="nav-price-link" class="nav__link" href="#">Стоимость</a>
                            </li>
                            <li class="nav__item">
                             <a id="nav-blog-link" class="nav__link" href="#">Блог</a>
                            </li>
                            <li class="nav__item">
                                <a id="nav-contacts-link" class="nav__link" href="#">Контакты</a>
                            </li>
                        </ul>
                    </nav>
                    <div class="header__cta">
                        <button id="header-consultation-button" class="btn" type="button">Консультация</button>
                        <div class="header__switch">
                            <button id="header-widget-toggle-button" class="btn btn--ghost" type="button" (click)="toggleHeaderWidget()">{{ isClockVisible ? 'Показать кликер' : 'Показать время' }}</button>
                            @if (isClockVisible) {
                                <div id="header-live-clock" class="header__clock" aria-label="Текущая дата и время">{{ currentDateTime }}</div>
                            } @else {
                                <div id="header-click-counter" class="header__counter" aria-label="Счетчик кликов">
                                    <button id="header-click-decrease-button" class="counter__btn" type="button" (click)="decreaseCounter()" [disabled]="counter === 0" aria-label="Уменьшить">−</button>
                                    <span id="header-click-count-value" class="counter__value" aria-label="Текущее значение">{{ counter }}</span>
                                    <button id="header-click-increase-button" class="counter__btn" type="button" (click)="increaseCounter()" aria-label="Увеличить">+</button>
                                </div>
                            }
                        </div>
                    </div>
                </div>
            </div>
        </header>
        <main id="main">
            <section class="hero">
             <div class="container hero__inner">
                    <h1 class="hero__tittle">Насладись прогулкой в горах <br> с командой единомышленников</h1>
                    <form id="tour-search-form" class="search" #searchForm="ngForm" (ngSubmit)="onSearch()" action="#">
                        <div class="search__grid">
                            <label class="field">
                                <div class="field__control">
                                 <select id="tour-location-select" class="field__input field__select" name="location" required [(ngModel)]="selectedLocation">
                                        <option value="" disabled>Локация для тура</option>
                                        <option value="altai">Алтай</option>
                                        <option value="caucasus">Кавказ</option>
                                        <option value="baikal">Байкал</option>
                                    </select>
                                    <img class="field__icon" src="/arrow-down.svg" alt="">
                                </div>
                                <span class="field__hint">выберите из списка</span>
                            </label>
                            <label class="field">
                                <div class="field__control">
                                    <input id="tour-date-input" class="field__input" type="date" name="date" required [(ngModel)]="selectedDate">
                                    <img class="field__icon" src="/formkit-date.svg" alt="">
                                </div>
                                <span class="field__hint">укажите диапазон</span>
                            </label>
                            <label class="field">
                                <div class="field__control">
                                    <select id="tour-people-select" class="field__input field__select" name="people" required [(ngModel)]="selectedPeopleCount">
                                        <option value="" disabled>Участники</option>
                                        <option value="4">4</option>
                                        <option value="5">5</option>
                                        <option value="6">6</option>
                                        <option value="7">7</option>
                                        <option value="8">8+</option>
                                    </select>
                                    <img class="field__icon" src="/arrow-down.svg" alt="">
                                </div>
                                <span class="field__hint">выберите из списка</span>
                            </label>
                            <div class="search__submit">
                                <button id="tour-search-submit-button" class="btn btn--light" type="submit" [disabled]="searchForm.invalid" >Найти программу</button>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="live">
                    <label class="live__field">
                        <input
                            id="live-text-input"
                            class="live__input"
                            type="text"
                            placeholder="Пиши сюда…"
                            name="liveInputValue"
                            [(ngModel)]="liveInputValue"
                        />
                    </label>
                    <span id="live-text-value" class="live__value" aria-label="Введённый текст">{{ liveInputValue }}</span>
                </div>
            </section>
            <section class="tour-about">
                <div class="tour-about__container">
                    <div class="tour-about__media">
                        <img
                            class="tour-about__preview tour-about__preview--back"
                            src="/mountains-peaks.png"
                            alt="Превью видео: горные пики в облаках"
                            width="350"
                            height="400"
                        >
                        <img
                            class="tour-about__preview tour-about__preview--front"
                            src="/mountain-valley.png"
                            alt="Превью видео: горная долина и домик"
                            width="350"
                            height="400"
                        >
                        <button class="tour-about__play" type="button" aria-label="Смотреть видео">
                            <img src="/play-icon.svg" alt="play-icon" width="50" height="50">
                        </button>
                    </div>
                    <div class="tour-about__content">
                        <span class="tour-about__eyebrow">о нашем походе</span>
                        <h2 class="tour-about__title">Исследуйте все горные массивы мира вместе с нами</h2>
                        <p class="tour-about__text">Его корни уходят в один фрагмент классической латыни 45 года н.э., 
                            то есть более двух тысячелетий назад. Ричард МакКлинток, профессор латыни из колледжа Hampden-Sydney, 
                            штат Вирджиния, взял одно из самых странных слов в Lorem Ipsum, "consectetur"и занялся его поисками 
                            в классической латинской литературе.</p>
                        <button class="tour-about__button" type="button" (click)="showWarnMsg('Программа недоступна')">Программа тура</button>
                    </div>
                </div>
            </section>
            <section class="offer">
                <div class="offer__container">
                    <div class="offer__content">
                        <span class="offer__eyebrow">наше предложение</span>
                        <h2 class="offer__title">Лучшие программы для тебя</h2>
    
                        <p class="offer__text">Его корни уходят в один фрагмент классической латыни 45 года н.э., 
                            то есть более двух тысячелетий назад. Ричард МакКлинток, профессор латыни из колледжа.</p>
                        <ul class="offer__list">
                            @for (offer of offers; track offer.id) {
                                <li class="offer__item">
                                    <div class="offer__icon" [class]="'offer__icon--' + offer.iconModifier">
                                        <img [src]="offer.icon + '.svg'" [alt]="offer.icon" width="36" height="36">
                                    </div>
    
                                    <div class="offer__item-body">
                                        <h3 class="offer__item-title">{{ offer.title }}</h3>
                                        <p class="offer__item-text">{{ offer.text }}</p>
                                    </div>
                                </li>
                            }
                        </ul>
                        <button class="offer__button" type="button" (click)="showInfoMsg('Стоимость отправлена на почту')">Стоимость программ</button>
                    </div>
                    <div class="offer__gallery">
                        <img class="offer__photo offer__photo--tl" src="/hand-with-coffee.png" alt="hand-with-coffee">
                        <img class="offer__photo offer__photo--tr" src="/man.png" alt="man">
                        <img class="offer__photo offer__photo--bl" src="/man-and-snowmobile.png" alt="man-and-snowmobile">
                        <img class="offer__photo offer__photo--br" src="/mountainous-terrain.png" alt="mountainous-terrain">
                    </div>
                </div>
            </section>
            <section class="popular">
                <div class="section-head">
                    <p class="section-head__kicker">по версии отдыхающих</p>
                    <h2 class="section-head__title">Популярные направления</h2>
                    <div class="popular__cards">
                        @for (card of cards; track card.id) {
                            <article class="card">
                                <img class="card__img" [src]="'/' + card.img + '.png'" [alt]="card.title"/>
                                <div class="card__rating">
                                    <img class="card__star" src="/star-icon.svg" alt="star-icon" width="24" height="24">
                                    <span class="card__rating-value">{{ card.rating }}</span>
                                </div>
                                <div class="card__bottom">
                                    <div class="card__text">
                                        <h3 class="card__name">{{ card.title }}</h3>
                                        <p class="card__desc">{{ card.subtitle }}</p>
                                    </div>
                                    <div class="card__price">{{ card.price }} $</div>
                                </div>
                            </article>
                        }
                    </div>
                    <div class="popular__actions">
                        <button id="popular-rating-button" class="popular__btn" type="button" (click)="showSuccessMsg('Направления получены')">Рейтинг направлений</button>
                    </div>
                </div>
            </section>
            <section class="blog">
                <div class="section-head">
                    <p class="section-head__kicker">делимся впечатлениями</p>
                    <h2 class="section-head__title">Блог о путешествиях</h2>
                    <div class="blog__grid">
                        @for (post of blogPosts; track post.id) {
                            <article class="blog-card">
                                <div class="blog-card__media">
                                    <img class="blog-card__img" [src]="'/' + post.img + '.png'" [alt]="post.title">
                                </div>
                                <div class="blog-card__content">
                                    <h3 class="blog-card__heading">{{ post.title }}</h3>
                                    <p class="blog-card__text">{{ post.text }}</p>
                                    <div class="blog-card__footer">
                                        <time class="blog-card__date">{{ post.date }}</time>
                                        <a id="blog-post-more-link" class="blog-card__more" href="#">читать статью</a>
                                    </div>
                                </div>
                            </article>
                        }
                    </div>
                    <div class="blog__actions">
                        <button id="blog-more-materials-button" class="blog__btn" type="button" (click)="showErrorMsg('Материалы недоступны')">Другие материалы</button>
                    </div>
                </div>
            </section>
        </main>
    </div>
}
<ng-template #messageTpl let-type="type" let-text="text" let-msg="msg">
    <div class="notification" [class]="'notification notification--' + type">
        <div class="notification__icon" aria-hidden="true">
            <img src="/message-icon.svg" alt="" width="40" height="40" />
        </div>
        <div class="notification__body">
            <div class="notification__title">{{ type }}</div>
            <div class="notification__text">{{ text }}</div>
        </div>
        <button
            class="notification__close"
            type="button"
            aria-label="Закрыть"
            (click)="closeMsg(msg)"
        >
            <img src="/close-icon.svg" alt="" width="20" height="20" />
        </button>
    </div>
</ng-template>
